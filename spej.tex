% Copyright (c) <2017> <Masoud Behzadinasab>
% Created by Masoud Behzadinasab on 07-31-2017 

% Adjusting the documentclass article to the SPE publication format

%% After the documentclass is loaded, this file should be input
% \documentclass[10pt,fleqn,twoside]{article}
% \input{spej.tex}

%% Title page should look like something like
% \title{\TitleFont My Title \vspace*{-8pt}}
% \date{}
% \author{\AuthorFont \textbf{Author 1}, Affil 1; \textbf{Author 2} and \textbf{Author 3}, Affil 2}
% \maketitle
% \vspace*{-10pt}
% \thispagestyle{fancy}
% \let\thefootnote\relax\footnotetext{\CopyRightFont Copyright \textcopyright \ 2017 Society of Petroleum Engineers}
% \let\thefootnote\relax\footnotetext{\CopyRightFont Original SPE manuscript received for review XX YY 20ZZ. Revised manuscript received for review XX YY 20ZZ. Paper (SPE XX) peer approved XX YY 20ZZ.}

%% The corresponding bibliography style should be called too.
% \bibliographystyle{spej}

\usepackage[left=1in, right=0.5in, top=1in, bottom=0.65in]{geometry}
\usepackage{mathptmx}

\usepackage{titlesec}
\usepackage[scaled=1]{helvet}% Helvetica, served as a model for arial
\titleformat{\section}{\large\bfseries\sffamily}{\thesubsection.}{3pt}{}
\titleformat{\subsection}[runin]{\normalfont\bfseries}{\thesubsection.}{3pt}{}
\titleformat{\subsubsection}[runin]{\normalfont\bfseries\itshape}{\thesubsubsection.}{3pt}{}
\titlespacing*\section{0pt}{15pt}{4pt}
\titlespacing\subsubsection{16pt}{12pt}{4pt}

\usepackage[round]{natbib}
\setcitestyle{aysep={}}

% Header and Page numbering
\usepackage{fancyhdr}
\fancyhf{} % clear all header and footers
\renewcommand{\headrulewidth}{0pt} % remove the header rule
\fancyfoot[LE,RO]{\fontsize{9}{10} \selectfont \thepage} % Left side on Even pages; Right side on Odd pages
\fancyfoot[RE,LO]{\fontsize{9}{10} \selectfont 2017 SPE Reservoir Evaluation \& Engineering}
\pagestyle{fancy}
\fancypagestyle{plain}{%
  \fancyhf{}%
  \renewcommand{\headrulewidth}{0pt}%
  \fancyhf[lef,rof]{\thepage}%
}

% Fix Figure/Table captions
\usepackage{caption}
\DeclareCaptionLabelFormat{mylabel}{#1 #2---}
\DeclareCaptionFormat{myformat}{\fontsize{8}{9}\selectfont#1#2#3}
\captionsetup[figure]{font={bf,sf},format=myformat,labelformat=mylabel,labelsep=none,name=Fig.}
\captionsetup[table]{font=sf,labelformat=mylabel,labelsep=none,skip=0pt}
\usepackage{etoolbox}
\newcommand*{\TableFont}{\fontsize{8}{9}\sffamily}
\BeforeBeginEnvironment{tabular}{\begin{center}\TableFont}
\AfterEndEnvironment{tabular}{\end{center}}
%\BeforeBeginEnvironment{longtable}{\TableFont}

% In case the default table options are needed somewhere, mytab env can be used
\let\mytab\tabular
\let\endmytab\endtabular

% Title/Author fonts
\newcommand*{\TitleFont}{\fontsize{24}{28}\sffamily}
\newcommand*{\AuthorFont}{\fontsize{10}{12}\sffamily}

% Footnote adjustment
\newcommand*{\CopyRightFont}{\fontsize{7}{8}\sffamily}
\setlength{\footnotesep}{\baselineskip}
\makeatletter
\renewcommand\footnoterule{%
  \kern-3\p@
  \hrule\@width 5cm
  \kern2.6\p@}
\makeatother

% Footnote indentation
\usepackage[hang]{footmisc}
\setlength\footnotemargin{0em} 

% Equation indentation
\usepackage{amsmath}
\setlength{\mathindent}{0.5cm}

% Cross-references will be easier this way:
\usepackage{xparse}
\NewDocumentCommand \eref{ m }{%
    Eq.~\ref{eqn:#1}%
}
\NewDocumentCommand \fref{ m }{%
    \textbf{Fig.~\ref{fig:#1}}%
}
\NewDocumentCommand \tref{ m }{%
    \textbf{Table~\ref{tab:#1}}%
}
